{% comment %}
Language switcher component
{% endcomment %}

{% assign current_lang = page.lang | default: site.default_lang | default: "zh" %}

<div class="language-switcher flex items-center space-x-2">
  {% if current_lang == "zh" %}
    <span class="text-primary-300 text-sm font-medium px-2 py-1 rounded bg-primary-900">
      中文
    </span>
    <span class="text-gray-500">|</span>
    {% comment %}Check if this is a blog post page{% endcomment %}
    {% if page.url contains '/blog/' and page.layout == 'post' %}
      {% comment %}For blog posts, always redirect to English blog index for better UX{% endcomment %}
      <a href="/en/blog/" 
         class="text-gray-400 hover:text-primary-300 text-sm font-medium px-2 py-1 rounded hover:bg-gray-800 transition duration-200"
         title="Switch to English">
        English
      </a>
    {% else %}
      {% comment %}For other pages, use the standard English URL{% endcomment %}
      <a href="/en{{ page.url }}" 
         class="text-gray-400 hover:text-primary-300 text-sm font-medium px-2 py-1 rounded hover:bg-gray-800 transition duration-200"
         title="Switch to English">
        English
      </a>
    {% endif %}
  {% else %}
    {% assign chinese_url = page.url | replace: '/en', '' %}
    {% if chinese_url == '/' %}
      {% assign chinese_url = '/' %}
    {% elsif chinese_url contains '//' %}
      {% assign chinese_url = chinese_url | replace: '//', '/' %}
    {% endif %}
    {% comment %}Check if this is an English blog post{% endcomment %}
    {% if page.url contains '/en/blog/' and page.layout == 'post' %}
      {% comment %}For English blog posts, always redirect to Chinese blog index for better UX{% endcomment %}
      <a href="/blog/" 
         class="text-gray-400 hover:text-primary-300 text-sm font-medium px-2 py-1 rounded hover:bg-gray-800 transition duration-200"
         title="切换到中文">
        中文
      </a>
    {% elsif page.url == '/en/blog/' %}
      {% comment %}From English blog index, go to Chinese blog index{% endcomment %}
      <a href="/blog/" 
         class="text-gray-400 hover:text-primary-300 text-sm font-medium px-2 py-1 rounded hover:bg-gray-800 transition duration-200"
         title="切换到中文">
        中文
      </a>
    {% else %}
      {% comment %}For other English pages, use the standard Chinese URL{% endcomment %}
      <a href="{{ chinese_url }}" 
         class="text-gray-400 hover:text-primary-300 text-sm font-medium px-2 py-1 rounded hover:bg-gray-800 transition duration-200"
         title="切换到中文">
        中文
      </a>
    {% endif %}
    <span class="text-gray-500">|</span>
    <span class="text-primary-300 text-sm font-medium px-2 py-1 rounded bg-primary-900">
      English
    </span>
  {% endif %}
</div>
